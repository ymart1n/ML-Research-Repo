```{r}

## read in data required
mydata <- read.csv("https://stats.idre.ucla.edu/stat/data/binary.csv")

## view the first few rows of the data
head(mydata)
summary(mydata)

## split training set and testing test
train_sub = sample(nrow(mydata),0.75*nrow(mydata))

train_data = mydata[train_sub,]
test_data = mydata[-train_sub,]

## Build logistic regression model
admission_logistic <- glm(admit ~ gre + gpa + rank, data = train_data, family = "binomial")

summary(admission_logistic)
```
## ROC curve and AUC value
```{r}
## make predictions for test set
pre_logistic<-as.numeric(predict(admission_logistic,newdata=test_data,type="response")>0.5)
# Combine results obtained by both predictions and observation
obs_p_logistic = data.frame(prob=pre_logistic,obs=test_data$admit)
#output confusion matrix
table(test_data$admit,pre_logistic,dnn=c("true value","prediction value"))   
#plot ROC curve
library(pROC)
logistic_roc <- roc(test_data$admit,pre_logistic)
plot(logistic_roc, print.auc=TRUE, auc.polygon=TRUE, grid=c(0.1, 0.2),grid.col=c("green", "red"), max.auc.polygon=TRUE,auc.polygon.col="skyblue", print.thres=TRUE,main='Logistic Regression ROC Curve')
```

